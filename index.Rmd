---
title: "HCERES ERPI"
description: |
  Production de connaissances et activités concourant au rayonnement et à l’attractivité scientifique.
author:
    
  - first_name: "Mauricio"
    last_name: "Camargo"
    url: https://erpi.univ-lorraine.fr/people/Mauricio-Camargo/
    affiliation: ERPI
    affiliation_url: https://erpi.univ-lorraine.fr/
    orcid_id: 0000-0003-3867-2438 
  - first_name: "Fréderique"
    last_name: "Mayer"
    url: https://erpi.univ-lorraine.fr/people/Frederique-Mayer/
    affiliation: ERPI
    affiliation_url: https://erpi.univ-lorraine.fr/
    orcid_id: 
  - first_name: "Eric"
    last_name: "Bonjour"
    url: https://erpi.univ-lorraine.fr/people/Eric-Bonjour/
    affiliation: ERPI
    affiliation_url: https://erpi.univ-lorraine.fr/
    orcid_id: 0000-0001-7851-1095 
  - first_name: "Manon"
    last_name: "Enjolras"
    url: https://erpi.univ-lorraine.fr/people/Manon-Enjolras/
    affiliation: ERPI
    affiliation_url: https://erpi.univ-lorraine.fr/
    orcid_id: 0000-0003-4570-1989
        
  - first_name: "Fabio"
    last_name: "Cruz"
    url: https://erpi.univ-lorraine.fr/people/Fabio-Cruz/
    affiliation: ERPI
    affiliation_url: https://erpi.univ-lorraine.fr/
    orcid_id: 0000-0001-8529-5327
date: "`r Sys.Date()`"
#output: distill::distill_article
site: distill::distill_website
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = FALSE)
require(tidyverse)
require(knitr)
require(kableExtra)
require(DT)
library(rmarkdown)

theme_fabio <- function(base_size = 12, base_family = "Palatino"){
  theme_minimal(base_size = base_size, base_family = base_family) %+replace%
    theme(
      #line = element_line(colour="black"),
      #text = element_text(colour="black"),
      #axis.title = element_text(size = 14),
      #axis.text = element_text(colour="black", size=8),
      #strip.text = element_text(size=12),
      #legend.key=element_rect(colour=NA, fill =NA),
      #panel.grid = element_blank(),   
      #panel.border = element_rect(fill = NA, colour = "black", size=1),
      #panel.background = element_rect(fill = "white", colour = "black"), 
      #strip.background = element_rect(fill = NA),
      #plot.title = element_text(family = "Palatino", color="#666666", face="bold", size=20, hjust=0)
      )
}


  

  
  
```


# Critères d'evaluation

```{r table-evaluation, layout="l-body-outset"}

Criteria <- tribble(
  ~Type,  ~Production,
  "Articles scientifiques", "77",
  "Articles de sythèse / revues bibliographiques", "",
  "Autres articles (articles publiés dans des revues professionnelles ou techniques, etc)", " ",
  
  "Monographies, éditions critiques, traductions", " ",
  "Direction et coordination d'ouvrages scientifiques / édition scientifique", " ",
  "Direction et coordination d'ouvrages scientifiques / édition scientifique en anglais ou dans une autre langue étrangère", " ",
  "Chapitres d'ouvrage", " ",
  "Chapitres d'ouvrages en anglais ou dans une autre langue étrangère", " ",
  "Thèse éditées", "16",
  "Editions d'actes de colloques / congrès", "",
  "Articles publiés dans des actes de colloques / congrès", "81",
  "Autres produits présentés dans des colloques / congrès et des séminaires de recherche", "",
  
  "Logiciels", "",
  "Base de données", "",
  "Outils d'aide à la désicion", "",
  "Cohortes", "",
  
  
  "Prototypes et démostrateurs", "",
  "Plateformes et observatoires", "",
  
  "Créations artistiques théorisées, mises en scènes, films", "",
  
  "Participation à des comités éditoriaux (journaux scientifiques, revues, collections, etc)", "",
  "Direction de collection et de séries", "",
  
  "Evaluation d'articles et d'ouvrages scientifiques (relecture d'articles / reviewing)", ""
  
)

```

```{r table-evaluation-1, layout="l-body-outset"}
Criteria %>% 
  kbl( caption = "Indicators for ERPI 2016 - 2020") %>%
  kable_paper("hover", full_width = F) %>% 
  pack_rows("Journaux / revues", 1, 3) %>%
  pack_rows("Ouvrages", 4, 9) %>%
  pack_rows("Production dans des colloques / congrès, séminaires de recherche", 10, 12) %>%
  pack_rows("Produits et outils informatiques", 13, 16) %>%
  pack_rows("Développements instrumentaux et méthodologiques", 17, 18) %>%
  pack_rows("Autres produits propres à une discipline", 19, 19) %>%
  pack_rows("Activités éditoriales", 20, 21) %>%
  pack_rows("Activités d'évaluation", 22, 22)
  
  
```


---

# Database from HAL 2016 - 2020

Last update from HAL:  "`r format(Sys.time(), '%d %B, %Y')`"


```{r HAL, include=FALSE}
# Data HAL ----
HAL <- read_csv("HAL/HAL-May-2021.csv") %>% 
  select(uri_s, title_s, authFullName_s, docType_s, doiId_s, publicationDateY_i, journalTitle_s, journalPublisher_s, conferenceTitle_s, language_s )

## Selecting the rubrics
  ## Total data
HAL <- HAL %>% set_names("Url", "Title", "Authors", "Type.document", "DOI", "Year", "Journal", "Publisher", "Conference", "Language")

  ## Filtering 2016 and tolower
HAL <- HAL %>% filter(Year >= 2016, Year<2021)
HAL$Journal = tolower(HAL$Journal)

#write.csv2(HAL, "HAL/HAL-2016-2020.csv")
#write_csv2(HAL, "HAL/HAL-2016-2020.csv")
#write_excel_csv2(HAL, "HAL/HAL-2016-2020-excel.csv")


# Data Scopus ----

Scopus <- read_csv2("Scopus/Scopus-2019.csv") 
Scopus = Scopus %>%  rename(Journal = Title)
Scopus$Journal = tolower(Scopus$Journal)
Journal_scopus <- factor(Scopus$Journal) %>% unique()

#HAL <- HAL %>% left_join(Scopus, by= "Journal")

names(HAL)
HAL <- 
  HAL %>%
  mutate(
    Scopus = case_when(
      HAL$Journal %in% Journal_scopus ~ "Oui",
      TRUE                      ~ "Non"
    )
  )
```


```{r Scimago, include=FALSE}
# Scimago ----
## Engineering
Engineering.Scimago <- read.csv2("HAL/Scimago/Engineering.csv") %>%  select(Title, SJR.Best.Quartile, H.index)
Engineering.Scimago <-  Engineering.Scimago %>% set_names("Journal", "Scimago<br/>Engineering", "H.Factor")
Engineering.Scimago$Journal = tolower(Engineering.Scimago$Journal)


## Decision Science
DS.Scimago <- read.csv2("HAL/Scimago/Decision-sciences.csv") %>%  select(Title, SJR.Best.Quartile, H.index)
DS.Scimago <-  DS.Scimago %>% set_names("Journal", "Scimago<br/>Decision<br/>Sciences", "H.Factor")
DS.Scimago$Journal = tolower(DS.Scimago$Journal)



# ERPI PUblications
ERPI <- left_join(HAL, Engineering.Scimago, by="Journal" )
ERPI <- left_join(ERPI, DS.Scimago, by="Journal" )


## H factor
ERPI <-  ERPI %>% mutate(H.Factor = coalesce(H.Factor.x, H.Factor.y))


ERPI <- ERPI %>% select(Year,Type.document , Title, Authors, DOI, Journal, 'Scimago<br/>Engineering', 'Scimago<br/>Decision<br/>Sciences' , Publisher, Conference,Language ,  Url, H.Factor)


ERPI <- ERPI %>%arrange(desc(Year), Type.document)
names(ERPI)

#write_excel_csv2(ERPI, "HAL/ERPI-2016-2020.csv")
```



```{r , include=FALSE, layout="l-screen-inset"}
HAL %>% select(Year, Type.document, Title, Authors, Journal) %>%  #, 'Scimago<br/>Engineering', 'Scimago<br/>Decision<br/>Sciences', H.Factor) %>% 
  datatable(. , escape = FALSE ,  options = list(
  pageLength = 1,
  lengthMenu = c(1, 5, 10, 15, 20)
))  %>% 
  DT::formatStyle(columns = colnames(.), fontSize = '12pt')
```


## Evolution of ERPI's Scientific production


```{r Production_total, layout="l-body-outset", fig.width=8, fig.height=4 }

# Filtering by Article, Conference and THesis
Production <- HAL %>% filter(Type.document == "ART" | Type.document == "COMM" | Type.document == "THESE")

# Counting the total production
total <- Production %>% group_by(Type.document) %>% summarise(total = sum(n()))

# Total of articles
Production %>% group_by(Year, Type.document) %>% tally(name = "Quantity") %>% 
  ggplot(aes(x=Year, y=Quantity, color = Type.document )) +
  geom_line() + geom_point() +
  labs(x="Années", y="Nombre des documents", title = "Production scientifique ERPI", subtitle = "Articles, Conferences  et Thèses doctorat") +
  scale_colour_discrete(name  ="Total par type\nde publication",
                            breaks=c("ART", "COMM", "THESE"),
                            labels=c(paste0("Articles = ", total$total[1]),
                                     paste0("Conferences = ", total$total[2]),
                                     paste0("Phd Thèses = ", total$total[3])
                                     )) +
      # scale_shape_discrete(name  ="Type de document",
      #                       breaks=c("ART", "COMM", "THESE"),
      #                       labels=c("Article", "Conferences", "Phd Thèses"))
  coord_cartesian(ylim = c(0, 30)) +
  theme_fabio()

  
```

## Journals

```{r Journals, layout="l-body-outset", fig.width=8, fig.height=4 }

# Create test data.
Articles <- HAL %>% filter(Type.document == "ART") %>% arrange(desc(Year))

Journals <- Articles  %>% group_by(Journal) %>% summarise(Quantity=n()) %>% mutate(Journal=factor(Journal, Journal))


Journals %>%
   arrange(Quantity) %>%
   filter(Quantity >= 2) %>%
   mutate(Journal=factor(Journal, Journal)) %>%
   ggplot( aes(x=Journal, y=Quantity) ) +
   geom_segment( aes(x=Journal ,xend=Journal, y=0, yend=Quantity), color="grey") +
   geom_point(size=3, color="#69b3a2") +
   coord_flip() +
   theme_fabio() +
   #theme_minimal(base_size = 15, base_family = "Palatino") +
   labs(x = "", y = "Quantité  d'article", title = "Journaux scientifiques principaux",
        subtitle = "Minimum 2 articles dans ces Journaux") +
   #    theme_ipsum() +
   theme(
      panel.grid.minor.y = element_blank(),
      panel.grid.major.y = element_blank(),
      legend.position="none"
   ) +
   xlab("")


```


## Analyse SCOPUS

Journaux referencés par Scopus et par annés depuis les publication ERPI


```{r, layout="l-screen-inset", include=TRUE}

Revistas <- 
  HAL %>% filter(Type.document == "ART") %>% arrange(desc(Year)) %>% 
    select(Year, Title, Authors, Journal, Scopus)

#paged_table(Revistas, options = list(cols.min.print=2))

# library(flextable)
# flextable(Revistas)

Revistas %>% mutate(N=rownames(Revistas)) %>% select(N,Year:Scopus) %>% 
  kbl( caption = "Articles for ERPI 2016 - 2020") %>%
  kable_paper("hover", full_width = F)

```


```{r Scopus-1}
Articles <- HAL %>% filter(Type.document == "ART") %>% arrange(desc(Year))

Articles %>% group_by(Year, Scopus) %>% tally(name = "Quantity") %>% 
  ggplot(aes(x=Year, y=Quantity, color = Scopus )) +
  geom_line() + geom_point() +
  labs(x="Années", y="Nombre des documents", title = "Articles listés dans la base SCOPUS", subtitle = "") +
  theme_fabio()
```


### Sous-domaines selons Scopus

SCOPUS a une serie de Sous domaine lié à chaque journal. 
Dans ce wordcloud, une presentation des sous-domaines en tulisant les journaux references Scopus publiés par ERPI dans la periode 2016-2020

```{r, layout="l-body-outset", fig.width=8, fig.height=4}
library(wordcloud2)
Domaines <- 
  HAL %>% 
  filter(Type.document == "ART") %>% 
  filter(Scopus == "Oui") %>% 
  left_join(Scopus, by= "Journal") %>% 
  select("Scopus Sub-Subject Area") %>% 
  group_by(`Scopus Sub-Subject Area`) %>% 
  tally(sort = TRUE, name = "Frequency") 

wordcloud2(data = Domaines,  shape = 'circle', size=0.2 ) 

```

### Analyse CiteScore 

Scopus utilise cette mésure au lieu d'Impact factor utilisé par Thomson-Reuters

```{r Citescore}

# Obtaining the CIteScore  
Citescore <-  Scopus %>% select(Journal, CiteScore) %>% unique()

Articles <- 
  HAL %>% 
  filter(Type.document == "ART") %>% 
  filter(Scopus == "Oui") %>% 
  left_join(Citescore, by= "Journal")  
  
Articles$Year <- as.factor(Articles$Year)

Articles %>% 
  ggplot( aes(x=Year, y=CiteScore)) +
    geom_boxplot(fill="slateblue", alpha=0.5) +
  labs(x="Années", y="CiteScore", title = "Profile CiteScore de l'ERPI", subtitle = "") +
  theme_fabio()
```


## Quartiles of the Publications

```{r}

Qs <- 
  HAL %>% 
  filter(Type.document == "ART") %>% 
  filter(Scopus == "Oui") %>% 
  left_join(Scopus, by= "Journal") %>% 
  select("Scopus Sub-Subject Area") %>% 
  group_by(`Scopus Sub-Subject Area`) %>% 
  tally(sort = TRUE, name = "Frequency") 
  


```



## Analyse JCR (Impact Factor)

```{r}

JCR <- read_csv("JCR/JCR.csv")
Qs <- 
  HAL %>% 
  filter(Type.document == "ART") %>% 
  filter(Scopus == "Oui") %>% 
  left_join(Scopus, by= "Journal") %>% 
  select("Scopus Sub-Subject Area") %>% 
  group_by(`Scopus Sub-Subject Area`) %>% 
  tally(sort = TRUE, name = "Frequency") 
  


```


<!-- ### Scimago Engineering -->

```{r, layout="l-body-outset", fig.width=8, fig.height=4, include=FALSE, eval=FALSE}

Articles %>% group_by(Year, `Scimago<br/>Engineering`) %>% tally(name = "Quantity") %>% 
  ggplot(aes(x=Year, y=Quantity, color = `Scimago<br/>Engineering` )) +
  geom_line() + geom_point() +
  labs(x="Années", y="Nombre des documents \n QuArtiles", title = "Production scientifique ERPI", subtitle = "Articles") +
  scale_colour_discrete(name  = "Scimago (Engineering)" ) +

                            #breaks=c("Q1", "Q2", "NA"),
                            #labels=c("Q1", "Q2", "à Identifier")) +
      # scale_shape_discrete(name  ="Type de document",
      #                       breaks=c("ART", "COMM", "THESE"),
      #                       labels=c("Article", "Conferences", "Phd Thèses"))
  theme_fabio() +
  coord_cartesian(ylim = c(0, 25))
  
```

<!-- ### Scimago Desicion Sciences -->

```{r, layout="l-body-outset", fig.width=8, fig.height=4, include=FALSE, eval=FALSE }


Publications %>% group_by(Year, `Scimago<br/>Decision<br/>Sciences`) %>% tally(name = "Quantity") %>% 
  ggplot(aes(x=Year, y=Quantity, color = `Scimago<br/>Decision<br/>Sciences` )) +
  geom_line() + geom_point() +
  labs(x="Années", y="Nombre des documents \n QuArtiles", title = "Production scientifique ERPI", subtitle = "Articles") +
  scale_colour_discrete(name  = "Scimago (Desicion Sciences)" ) +

                            #breaks=c("Q1", "Q2", "NA"),
                            #labels=c("Q1", "Q2", "à Identifier")) +
      # scale_shape_discrete(name  ="Type de document",
      #                       breaks=c("ART", "COMM", "THESE"),
      #                       labels=c("Article", "Conferences", "Phd Thèses"))
  theme_minimal() +
  theme(axis.text=element_text(size=14, family = "Palatino"),
        axis.title=element_text(size=16,face="bold", family = "Palatino"),legend.position="right")+
  theme(plot.title = element_text(family = "Palatino", color="#666666", face="bold", size=20, hjust=0)) +
  coord_cartesian(ylim = c(0, 25))
  
```




